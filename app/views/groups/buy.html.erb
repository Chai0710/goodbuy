<div class="container bg-white rounded box-shadow mt-3 mb-3 pb-5 pt-5">  
    <h1>團名</h1>
    <div class="group-info d-flex align-items-center p-3 my-3">
      <ul>
        <li>電話：<%= @group.phone %></li>
        <li>地址：<%= @group.address %></li>
        <li>描述：<%= @group.description %></li>
      </ul>
    </div>

    <div class="menu-pic d-flex align-items-center justify-content-center mb-5">
      <% if @group.shop_photo.attached? %>
        <div class="row justify-content-center">
        <%= image_tag @group.shop_photo.variant(resize: "300x300"), class: "group-img " %>
        </div>
      <% end %>
    </div>



  <div id="tab-demo" class="m-auto">
      <ul class="tab-title">
          <li><a href="#tab01">我要跟團</a></li>
          <li><a href="#tab02">我要結帳</a></li>
          <li><a href="#tab03">看看其他人買了什麼</a></li>
      </ul>

      <div id="tab01" class="tab-inner">
        <form>
          <h6 class="border-bottom border-gray pb-2">請選擇品項</h6>
          <div class="row media-body pb-3 lh-125 border-bottom border-gray mt-3">
            <div class="products col-6">
              <% @products.each do |p| %>
                <div class="product" data-product= "<%= p.id %>">
                  <%= radio_button_tag(:p, p.price ) %> <%= p.name %> <%= p.price %>元
                </div>
              <% end %>
            </div>
            <div class="options col-6">
              <% @options.each do |o| %>
                <div class="option" data-option= "<%= o.id %>">
                  <%= check_box_tag(:o, o.price) %>
                  <%= o.name %> <%= o.price %>元
                </div>
              <% end %>
            </div>
          </div>
          <div class="rounded mt-3">價格：<span class="total-price"></span></div>
          <button class='mt-3 btn btn-success btn-sm' id='buy'>買吧買吧</button>
        </form>
      </div>

      <div id="tab02" class="tab-inner">
        <h6 class="border-bottom border-gray pb-2">我的購買清單</h6>
        <div class="order-items media text-muted pt-3">
          <img data-src="holder.js/32x32?theme=thumb&bg=007bff&fg=007bff&size=1" alt="" class="mr-2 rounded">
          
          <%= form_with url: checkout_group_path, local: true do |form| %>
            <div id='order-item'>
            </div>
            <%= form.submit '結帳囉', :class => 'mt-3 btn btn-warning btn-sm' %>
          <% end %>
        </div>        
      </div>

      <div id="tab03" class="tab-inner">
          <h6>所有人的購買清單</h6>
          <table class= "table">
              <thead>
              <tr>
                <td>購買人</td>
                <td>品名</td>
                <td>選項</td>
                <td>單價</td>
                <td>數量</td>
                <td>合計</td>
              </tr>
              </thead>
              <tbody>
                <% @group.orders.each do |order| %>
                  <% order.order_items.each do |order_item| %>
                    <tr>
                      <td>
                        <%= order_item.order.buyer.name %>
                      </td>
                      <td>
                        <%= order_item.product.name %>
                      </td>
                      <td>
                        <% order_item.options.each do |option| %>
                          <%= option.name %>
                          (+<%= option.price %>元)
                        <% end %>
                      </td>
                      <td>
                        <%= order_item.product.price %>
                      </td>
                      <td>
                        <%= order_item.quantity %>
                      </td>
                      <td>
                        <% order_item_price = order_item.product.price %>
                        <% order_item.options.each do |option| %>
                          <% order_item_price += option.price %>
                        <% end %>
                        <%= order_item_price%>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
              </tbody>
          </table>
      </div>
      
  </div>

</div>